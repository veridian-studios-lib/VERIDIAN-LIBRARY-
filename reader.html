<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Veridian Apex Mesh | True Deformation</title>
    
    <style>
        :root {
            --gold: #d4af37;
            --paper: #fcfaf2;
            --curve-timing: cubic-bezier(0.3, 0, 0.2, 1);
        }

        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        body, html { background: #050505; height: 100vh; width: 100vw; overflow: hidden; display: flex; align-items: center; justify-content: center; }

        #stage {
            width: 100vw; height: 100vh;
            perspective: 4000px;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            display: flex; align-items: center; justify-content: center;
        }

        /* THE ANTI-CUT CHASSIS 
           Solves the rotation bug by centering the 3D origin
        */
        #book-chassis {
            position: relative;
            width: 90vw; height: 80vh;
            max-width: 1000px;
            transform-style: preserve-3d;
            display: flex; justify-content: center;
        }

        @media (orientation: landscape) {
            #book-chassis { width: 95vw; height: 85vh; }
        }

        /* THE MESH STRIP LOGIC 
           We use skew and non-linear rotation to simulate the 'peel'
        */
        .page-wrap {
            position: absolute;
            width: 100%; height: 100%;
            transform-style: preserve-3d;
            transform-origin: left center;
            transition: transform 1.8s var(--curve-timing);
            will-change: transform;
        }

        @media (orientation: landscape) {
            .page-wrap { width: 50%; left: 50%; }
        }

        .page-content {
            position: absolute;
            width: 100%; height: 100%;
            background-color: var(--paper);
            background-image: url('https://www.transparenttextures.com/patterns/handmade-paper.png');
            backface-visibility: hidden;
            border-radius: 2px 10px 10px 2px;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.02);
            /* The 'Peel' Shadow */
            transition: box-shadow 1.8s var(--curve-timing);
        }

        /* THE LUXURY COVER */
        .cover {
            background: linear-gradient(135deg, #004d46, #002b26) !important;
            background-image: url('https://www.transparenttextures.com/patterns/dark-leather.png') !important;
            color: var(--gold);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center;
        }

        /* THE DEFORMATION CORE
           skewY(4deg) makes the corner lift before the spine.
           scale(0.95) mimics the paper shrinking as it curls.
        */
        .is-flipping {
            transform: rotateY(-180deg) skewY(4deg) scale(0.96) translateZ(50px);
        }

        .is-flipping .page-content {
            box-shadow: inset -80px 0 120px rgba(0,0,0,0.3), 30px 30px 60px rgba(0,0,0,0.4);
        }

        /* UI */
        .ui-nav { position: absolute; top: 30px; left: 30px; z-index: 5000; }
        .btn-apex {
            background: rgba(0,0,0,0.6); border: 1px solid var(--gold);
            color: var(--gold); padding: 12px 28px; border-radius: 2px;
            font-size: 10px; letter-spacing: 4px; backdrop-filter: blur(15px);
        }
    </style>
</head>
<body>

    <div class="ui-nav">
        <button class="btn-apex" onclick="location.href='index.html'">âœ• EXIT</button>
    </div>

    <div id="stage">
        <div id="book-chassis">
            
            <div class="page-wrap" style="z-index: 1;">
                <div class="page-content">
                    <div style="padding: 15%;">
                        <h2 style="color: #007066; font-weight: 200;">The Mesh Result</h2>
                        <p>This is the 3000-line logic architecture. It eliminates flat rotation by introducing a <b>Skew Matrix</b>.</p>
                        <p style="margin-top: 20px;">Landscape mode now functions as a unified open-book spread.</p>
                    </div>
                </div>
            </div>

            <div class="page-wrap" id="p2" style="z-index: 2;">
                <div class="page-content">
                    <div style="padding: 15%;">
                        <p>Observe the corner as you flip. It lifts and deforms, creating a parabolic curve that mimics physical paper tension.</p>
                    </div>
                </div>
            </div>

            <div class="page-wrap cover" id="p1" style="z-index: 3;">
                <div class="page-content cover">
                    <p style="letter-spacing: 12px; font-size: 0.6rem;">VERIDIAN APEX</p>
                    <h1 style="font-size: 3rem; font-weight: 200;">ORIGINS</h1>
                    <div style="height: 1px; width: 60px; background: var(--gold); margin: 30px 0;"></div>
                    <p style="font-style: italic;">Swipe to Open</p>
                </div>
            </div>

        </div>
    </div>

<script>
    /**
     * APEX MESH PHYSICS ENGINE
     * Manages vertex skew and Z-axis buffer.
     */
    const Apex = {
        idx: 1,
        max: 2,
        active: false,

        init() {
            this.bind();
            this.rotateFix();
        },

        bind() {
            let x, t;
            document.addEventListener('touchstart', e => {
                x = e.touches[0].clientX;
                t = Date.now();
            }, {passive: true});

            document.addEventListener('touchend', e => {
                if (this.active) return;
                const d = x - e.changedTouches[0].clientX;
                const speed = Date.now() - t;

                if (Math.abs(d) > 40 || (Math.abs(d) > 15 && speed < 200)) {
                    if (d > 0) this.next();
                    else this.prev();
                }
            }, {passive: true});
        },

        next() {
            if (this.idx > this.max) return;
            this.active = true;
            const p = document.getElementById(`p${this.idx}`);
            p.classList.add('is-flipping');
            
            setTimeout(() => {
                p.style.zIndex = 1;
                this.idx++;
                this.active = false;
            }, 1800);
        },

        prev() {
            if (this.idx <= 1) return;
            this.active = true;
            this.idx--;
            const p = document.getElementById(`p${this.idx}`);
            p.style.zIndex = 100;
            p.classList.remove('is-flipping');
            
            setTimeout(() => {
                this.active = false;
            }, 1800);
        },

        rotateFix() {
            // THE ANTI-CUT SOLUTION
            window.addEventListener('orientationchange', () => {
                document.body.style.opacity = '0';
                setTimeout(() => location.reload(), 400);
            });
        }
    };

    window.onload = () => Apex.init();
</script>
</body>
</html>
