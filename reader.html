<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Veridian Archive | Sanctum Reader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Fauna+One&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #D4AF37; --paper: #F3F0E6; }
        body { 
            font-family: 'Fauna One', serif; background: #050505;
            margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh;
        }

        .lamp-glow {
            position: absolute; width: 100vw; height: 100vh;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.08) 0%, transparent 70%);
            pointer-events: none; z-index: 0;
        }

        /* The Book Stage */
        .stage {
            position: relative; width: 90vw; max-width: 500px; height: 82vh;
            perspective: 2500px; z-index: 10;
        }

        .page {
            position: absolute; inset: 0; background: var(--paper);
            border-radius: 8px 40px 40px 8px; padding: 40px; color: #1F150D;
            box-shadow: -15px 15px 50px rgba(0,0,0,0.8), inset 20px 0 40px rgba(0,0,0,0.05);
            transform-origin: left center;
            transition: transform 1.2s cubic-bezier(0.645, 0.045, 0.355, 1), opacity 0.6s ease, box-shadow 1s;
            backface-visibility: hidden;
        }

        /* THE CURVY PEEL: This simulates the "rolled" look from the video */
        .peel-animation {
            transform: rotateY(-110deg) skewY(-10deg) scaleX(0.8) translateZ(50px);
            box-shadow: 50px 50px 100px rgba(0,0,0,0.5);
            opacity: 0;
        }

        /* The Gold Highlight - One sentence at a time */
        .sentence { transition: all 0.5s ease; border-radius: 4px; padding: 0 4px; }
        .reading-now { 
            background-color: rgba(212, 175, 55, 0.35); 
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
            color: #000;
        }

        .content-area { font-size: 1.15rem; line-height: 2; text-align: justify; height: 100%; }

        /* Navigation */
        .nav-dock {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            display: flex; align-items: center; gap: 60px; z-index: 100;
        }
        .nav-btn { color: var(--gold); font-size: 2rem; opacity: 0.5; transition: 0.3s; cursor: pointer; background: none; border: none; }
        .nav-btn:hover { opacity: 1; transform: scale(1.1); }
        .play-ring { width: 65px; height: 65px; border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div class="lamp-glow"></div>

    <div class="stage" id="stage">
        <div class="page" id="page-back" style="z-index: 1;">
            <div id="back-content" class="content-area opacity-40"></div>
        </div>
        <div class="page" id="page-top" style="z-index: 2;">
            <div id="front-content" class="content-area"></div>
        </div>
    </div>

    <div class="nav-dock">
        <button onclick="turnPage(-1)" class="nav-btn">◁</button>
        <div class="play-ring">
            <button onclick="toggleNarrator()" id="play-btn" class="nav-btn">▶</button>
        </div>
        <button onclick="turnPage(1)" class="nav-btn">▷</button>
    </div>

    <script>
        const archive = [
            ["A reader lives a thousand lives before he dies.", "The man who never reads lives only one.", "In this sanctuary, time slows down."],
            ["Wisdom is the gold of the soul, refined by fire.", "The oak tree grows in silence, not in noise.", "Deep roots fear no wind."],
            ["Every page turned is a life rediscovered.", "The ancients speak in whispers to those who listen.", "The golden path is under your feet."]
        ];

        let pageIdx = 0;
        let sentIdx = 0;
        let isReading = false;
        let audioCtx;
        const synth = window.speechSynthesis;

        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function renderPage(targetId, pIdx) {
            const container = document.getElementById(targetId);
            container.innerHTML = archive[pIdx].map((s, i) => 
                `<span class="sentence" id="s-${pIdx}-${i}">${s} </span>`
            ).join('');
        }

        function turnPage(dir) {
            initAudio();
            if (dir === 1 && pageIdx < archive.length - 1) {
                const topPage = document.getElementById('page-top');
                topPage.classList.add('peel-animation');
                playPaperSFX();

                setTimeout(() => {
                    pageIdx++;
                    sentIdx = 0;
                    renderPage('front-content', pageIdx);
                    if(pageIdx + 1 < archive.length) renderPage('back-content', pageIdx + 1);
                    
                    topPage.style.transition = 'none';
                    topPage.classList.remove('peel-animation');
                    setTimeout(() => {
                        topPage.style.transition = 'transform 1.2s cubic-bezier(0.645, 0.045, 0.355, 1), opacity 0.6s ease';
                        if(isReading) speakSentence();
                    }, 50);
                }, 1100);
            } else if (dir === -1 && pageIdx > 0) {
                pageIdx--;
                sentIdx = 0;
                renderPage('front-content', pageIdx);
            }
        }

        function toggleNarrator() {
            initAudio();
            if (isReading) {
                synth.cancel();
                document.getElementById('play-btn').innerText = "▶";
                document.querySelector('.reading-now')?.classList.remove('reading-now');
            } else {
                document.getElementById('play-btn').innerText = "‖";
                speakSentence();
            }
            isReading = !isReading;
        }

        function speakSentence() {
            if (!isReading) return;
            
            // Highlight current sentence
            document.querySelectorAll('.reading-now').forEach(el => el.classList.remove('reading-now'));
            const el = document.getElementById(`s-${pageIdx}-${sentIdx}`);
            if (el) el.classList.add('reading-now');

            const msg = new SpeechSynthesisUtterance(archive[pageIdx][sentIdx]);
            msg.pitch = 0.6; msg.rate = 0.8;
            
            msg.onend = () => {
                if (!isReading) return;
                if (sentIdx < archive[pageIdx].length - 1) {
                    sentIdx++;
                    setTimeout(speakSentence, 600);
                } else {
                    setTimeout(() => turnPage(1), 1000);
                }
            };
            synth.speak(msg);
        }

        function playPaperSFX() {
            if(!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'brown-noise';
            gain.gain.setValueAtTime(0.03, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.6);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start();
        }

        // Setup Initial View
        renderPage('front-content', 0);
        renderPage('back-content', 1);
    </script>
</body>
</html>
